---
title: "Final Project"
author: "Introduction to R<br/>
  <a href='https://therbootcamp.github.io'>
     Bern R Bootcamp
  </a> 
  <br>
  <a href='https://dwulff.github.io/Intro2R_Unibe/'>
    <i class='fas fa-clock' style='font-size:.9em;'></i>
  </a>&#8239; 
  <a href='https://therbootcamp.github.io'>
    <i class='fas fa-home' style='font-size:.9em;' ></i>
  </a>&#8239;
  <a href='mailto:therbootcamp@gmail.com'>
    <i class='fas fa-envelope' style='font-size: .9em;'></i>
  </a>&#8239;
  <a href='https://www.linkedin.com/company/basel-r-bootcamp/'>
    <i class='fab fa-linkedin' style='font-size: .9em;'></i>
  </a>"
output:
  html_document:
    css: practical.css
    self_contained: no
---


```{r setup, echo = FALSE}
knitr::opts_chunk$set(comment = NA, 
                      fig.width = 6, 
                      fig.height = 6,
                      fig.align = 'center',
                      echo = TRUE, 
                      eval = TRUE, 
                      warning = FALSE)

options(digits = 3)
```

<p align="center">
<img width="100%" src="https://meetville.com/blog/wp-content/uploads/2015/01/imgonline-com-ua-Resize-quU8YQt7HJLDQEjt.jpg" margin=0><br>
<font style="font-size:10px">adapted from [meetville.com](https://meetville.com/blog/wp-content/uploads/2015/01/imgonline-com-ua-Resize-quU8YQt7HJLDQEjt.jpg)</font>
</p>


# {.tabset .tabset-fade}

## Overview

This is your final assignment in this course. You will use all we learned during the course to understand, arrange, analyse, visualise and report on a new dataset about medical appointments.

What is the dataset about? There is a large number of medical appointments where patients end up canceling or simply do not show up. This practise comes with huge costs to the medical system - in this assignment we will try to understand what drives patients not to show up in a sample of medical appointments from Brasil.

From the given list of parameters, such as Gender, Scheduled and Appointment Date difference, Age, Neighbourhood, sms_alert and certain conditions of a given patient, the model will predict, based on a studied dataset, whether the given appointment is likely to be a No-Show

You should (at least) complete the following tasks

1. load the two .csv files you find in `Datasets` into R objects 
2. 

## Tasks

### A - Setup

1. Open your `baselrbootcamp` R project. It should already have the folders `1_Data` and `2_Code`. Make sure that the data files listed in the `Datasets` section above are in your `1_Data` folder.

```{r}
# Done!
```

2. Open a new R script. At the top of the script, using comments, write your name and the date. Save it as a new file called `final_project.R` in the `2_Code` folder.  

3. Using `library()` load the set of packages for this practical listed in the packages section above.

4. Read the `medical_noshows.csv` and the `weather.csv` files into two objects called `appointments` and `weather` respectively. Check out the content of the two datasets in Overview and Datasets above.

```{r, echo = FALSE, eval = FALSE, message = FALSE, warning = FALSE}
appointments <- read_csv('1_Data/medical_noshows.csv')
weather <- read_csv('1_Data/weather.csv')
```

### B - Initial data inspection

1. We want to first see what variables are in the dataset (check out Datasets above) and whether there are variables with impossible values. Generate an overview of all variables with minimum and maximum values, means and medians for all appropriate numeric variables. Correct the variable(s) that stand out and provide a rational for what you did.

```{r, echo = TRUE, eval = FALSE, message = FALSE, warning = FALSE}
summary(appointments)

appointments <-
appointments %>%
  filter(Age >= 0)
```

2. How many patients showed up for their appointment(s), how many did not?

```{r, echo = TRUE, eval = FALSE, message = FALSE, warning = FALSE}
table(appointments$NoShow)
```

## Datasets

```{r, eval = TRUE, message = FALSE}
library(tidyverse)
appointments <- read_csv('1_Data/medical_noshows.csv')
weather <- read_csv('1_Data/weather.csv')
```

|File | Rows | Columns | Description |
|:----|:-----|:------|:-----------------------------------------|
|[medical_noshows.csv](1_Data/medical_noshows.csv) | 110527 | 14| Patient shows|no-shows for various cities in Brasil |
|[brazil_wheather.csv](1_Data/weather_per_coordinate.csv) | 2255 | 10| Weather data for various longitute and latitude coordinates in Brasil |

### Variables in medical_noshows.csv (appointments)

|Variable | Description |
|:--------|:-----------------------------|
|PatientId | ID of a patient |
|AppointmentID | ID for each appointment |
|Gender | Male or Female|
|ScheduledDay | The day of the actual appointment, when patients have to visit the doctor |
|AppointmentDay | The day someone called or registered the appointment, this should be before the appointment|
|Age | How old is the patient|
|Neighbourhood | Where the appointment takes place. |
|Scholarship | Ture of False. |
|Observation| this is a broad topic, consider reading this article https://en.wikipedia.org/wiki/Bolsa_Fam%C3%ADlia |
|Hypertension | True or False |
|Diabetes | True or False |
|Alcoholism | True or False |
|Handicapped | True or False |
|SMS_received | True: 1 or more messages sent to the patient|
|No-show | 1: No, 2: Yes|

### Variables in brazil_wheather.csv (weather)

|Variable | Description |
|:--------|:-----------------------------|
|LON  |Longitude|
|LAT  |Latitude|
|YEAR  |Year| 
|MM    |Month|
|DD   |Day|
|DOY |Day of Year|
|YYYYMMDD|Date|    
|RH2M   |Relative Humidity at 2 Meters|
|T2M |Temperature at 2 Meters|
|PRECTOT|Precipitation|


## Packages

|Package| Installation|
|:------|:------|
|`tidyverse`|`install.packages("tidyverse")`|
|`lubridate`|`install.packages("lubridate")`|
|`tidylog`|`devtools::install_github("elbersb/tidylog")`|

## Glossary (UPDATE!)

*Wrangling*

| Function| Package | Description |
|:---|:------|:---------------------------------------------|
|     `rename()`|`dplyr`|    Rename columns| 
|     `select()`|`dplyr`|    Select columns based on name or index| 
|     `filter()`|`dplyr`|    Select rows based on some logical criteria| 
|     `arrange()`|`dplyr`|    Sort rows| 
|     `mutate()`|`dplyr`|    Add new columns|
|     `case_when()`|`dplyr`|    Recode values of a column| 
|     `group_by(), summarise()`|`dplyr`|   Group data and then calculate summary statistics|
|     `left_join()`|`dplyr`|   Combine multiple data sets using a key column|
|     `spread()`|`tidyr`|    Convert long data to wide format - from rows to columns| 
|     `gather()`|`tidyr`|    Convert wide data to long format - from columns to rows|

*Statistical Tests*

| Function| Hypothesis Test|
|:------|:-------------------|
|     `t.test()`|    One and two sample t-test|
|     `cor.test()`|    Correlation test|
|     `glm()`, `lm()`|    Generalized linear model and linear model|

## Cheatsheets

<figure>
<center>
<a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf">
  <img src="https://www.rstudio.com/wp-content/uploads/2018/08/data-transformation-600x464.png" alt="Dplyr" style="width:70%">
  <figcaption>https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf</figcaption></a>
</figure>

<figure>
<center>
<a href="https://github.com/rstudio/cheatsheets/raw/master/lubridate.pdf">
  <img src="https://www.rstudio.com/wp-content/uploads/2018/08/lubridate-600x464.png" alt="Lubridate" style="width:70%">
  <figcaption>https://github.com/rstudio/cheatsheets/raw/master/lubridate.pdf</figcaption></a>
</figure>
