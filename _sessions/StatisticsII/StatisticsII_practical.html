<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Statistics II</title>

<script src="StatisticsII_practical_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="StatisticsII_practical_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="StatisticsII_practical_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="StatisticsII_practical_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="StatisticsII_practical_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="StatisticsII_practical_files/navigation-1.1/tabsets.js"></script>
<link href="StatisticsII_practical_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="StatisticsII_practical_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="practical.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Statistics II</h1>
<h4 class="author"><em><table style='table-layout:fixed;width:100%;border:0;padding:0;margin:0'>
<col width='10%'>
<col width='10%'>
<tr style="border:none">
<td style="display:block;width:100%;text-align:left;vertical-align:bottom;padding:0;margin:0;border:none" nowrap>
<font style='font-style:normal'>Introduction to R</font><br> <a href='https://dwulff.github.io/Intro2R_Unibe/'> <i class='fas fa-clock' style='font-size:.9em;' ></i> </a> <a href='https://therbootcamp.github.io'> <i class='fas fa-home' style='font-size:.9em;'></i> </a> <a href='mailto:therbootcamp@gmail.com'> <i class='fas fa-envelope' style='font-size: .9em;'></i> </a> <a href='https://www.linkedin.com/company/basel-r-bootcamp/'> <i class='fab fa-linkedin' style='font-size: .9em;'></i> </a> <a href='https://therbootcamp.github.io'> <font style='font-style:normal'>Bern R Bootcamp</font> </a>
</td>
<td style="width:100%;vertical-align:bottom;text-align:right;padding:0;margin:0;border:none">
<img src='https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/by-sa.png' style='height:15px;width:80px'/>
</td>
</tr>
</table></em></h4>

</div>


<p align="center">
<img width="100%" src="image/hansrosling.png" margin=0><br> <font style="font-size:10px">from <a href="https://www.ted.com/talks/hans_rosling_the_truth_about_hiv">TED.com</a></font>
</p>
<div id="section" class="section level1 tabset">
<h1></h1>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>In this practical you’ll do basic statistics in R. By the end of this practical you will know how to:</p>
<ol style="list-style-type: decimal">
<li>Calculate regression analyses with <code>glm()</code> and <code>lm()</code>.</li>
<li>Explore statistical objects with <code>names()</code>, <code>summary()</code>, <code>print()</code>, <code>predict()</code>.</li>
<li>Run mixed-model and Bayesian regressions using the <code>lme4</code> and <code>BayesFactor</code> packages.</li>
</ol>
</div>
<div id="tasks" class="section level2">
<h2>Tasks</h2>
<div id="a---getting-setup" class="section level3">
<h3>A - Getting setup</h3>
<ol style="list-style-type: decimal">
<li><p>Open your <code>BernRBootcamp</code> R project. It should already have the folders <code>1_Data</code> and <code>2_Code</code>. Make sure that all of the data files listed above are contained in the <code>1_Data</code> folder</p></li>
<li><p>Open a new R script and save it as a new file called <code>statistics_practical.R</code> in the <code>2_Code</code> folder. At the top of the script, using comments, write your name and the date. The, load the set of packages listed above with <code>library()</code>.</p></li>
<li><p>For this practical, we’ll use the <code>kc_house.csv</code> data. This dataset contains house sale prices for King County, Washington. It includes homes sold between May 2014 and May 2015. Using the following template, load the data into R and store it as a new object called <code>kc_house</code>.</p></li>
</ol>
<pre class="r"><code>gap &lt;- read_csv(file = &quot;XX&quot;)</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Using <code>print()</code>, <code>summary()</code>, and <code>head()</code>, explore the data to make sure it was loaded correctly.</li>
</ol>
</div>
<div id="b---descriptive-statistics" class="section level3">
<h3>B - Descriptive statistics</h3>
<ol style="list-style-type: decimal">
<li><p>What was the mean price (<code>price</code>) of all houses?</p></li>
<li><p>What was the median price (<code>price</code>) of all houses?</p></li>
<li><p>What was the standard deviation price (<code>price</code>) of all houses?</p></li>
<li><p>What were the minimum and maximum prices? Try using <code>min()</code>, <code>max()</code>, and <code>range()</code></p></li>
<li><p>How many houses were on the waterfront (<code>waterfront</code>) and how many were not? (Hint: use <code>table()</code>)</p></li>
</ol>
</div>
<div id="c---t-tests-with-t.test" class="section level3">
<h3>C - T tests with t.test()</h3>
<ol style="list-style-type: decimal">
<li>Do houses on the waterfront sell for more than those not on the waterfront? Answer this by creating an object called <code>water_htest</code> which contains the result of the appropriate t-test using <code>t.test()</code>. Use the following template</li>
</ol>
<pre class="r"><code>water_htest &lt;- t.test(formula = XX ~ XX,
                      data = XX)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><p>Print your <code>water_htest</code> object to see summary results</p></li>
<li><p>Apply the <code>summary()</code> function to <code>water_htest</code>. Do you see anything new or important?</p></li>
<li><p>Look at the names of the <code>water_htest</code> with <code>names()</code>. What are the named elements of the object?</p></li>
<li><p>Using the <code>$</code> operator, print the exact test statistic of the t-test.</p></li>
<li><p>Again using the <code>$</code> operator, print the exact p-value of the test.</p></li>
<li><p>Use the <code>tidy()</code> function to return a dataframe containing the main results of the test.</p></li>
<li><p>Do houses on the waterfront also tend to have more (or less) living space (<code>sqft_living</code>)? Answer this by conducting the appropriate t-test and going through the same steps you did in the previous question</p></li>
</ol>
</div>
<div id="d---correlation-tests-with-cor.test" class="section level3">
<h3>D - Correlation tests with cor.test()</h3>
<ol style="list-style-type: decimal">
<li>Do houses built in later years tend to sell for more than older houses? Answer this by creating an object called <code>time_htest</code> which contains the result of the appropriate correlation test using <code>cor.test()</code> and the columns <code>yr_built</code> and <code>price</code>. Use the following template:</li>
</ol>
<pre class="r"><code># Note: cor.terst() is the only function (we know of)
#  that uses formulas in the strange format
#   formula = ~ X + Y instead of formula = Y ~ X

time_htest &lt;- cor.test(formula = ~ XX + XX,
                       data = XX)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><p>Print your <code>time_htest</code> object to see summary results</p></li>
<li><p>Apply the <code>summary()</code> function to <code>time_htest</code>. Do you see anything new or important?</p></li>
<li><p>Look at the names of the <code>time_htest</code> with <code>names()</code>. What are the named elements of the object?</p></li>
<li><p>Using the <code>$</code> operator, print the exact correlation of the test (Hint: it’s called “estimate”)</p></li>
<li><p>Again using the <code>$</code> operator, print the exact p-value of the test.</p></li>
<li><p>Use the <code>tidy()</code> function to return a dataframe containing the main results of the test.</p></li>
<li><p>Do houses in in better overall condition <code>condition</code> tend to sell at higher prices than those in worse condition? Answer this by conducting the appropriate correlation test and going through the same steps you did in the previous question.</p></li>
</ol>
</div>
<div id="e---linear-regression-with-lm-and-glm" class="section level3">
<h3>E - Linear Regression with lm() and glm()</h3>
<ol style="list-style-type: decimal">
<li>In a previous question, you used a correlation test to see if houses built in later years <code>yr_built</code> tend to sell for more than older houses. Now let’s repeat the same analysis using a regression analysis with <code>lm()</code>. Do to this, use the following template:</li>
</ol>
<pre class="r"><code>time_lm &lt;- lm(formula = XX ~ XX,
                 data = XX)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><p>Print your <code>time_lm</code> object to see the main results.</p></li>
<li><p>Use the <code>tidy()</code> function (from the <code>broom</code> package) to return a dataframe containing the main results of the test.</p></li>
<li><p>How does the p-value of this test compare to what you got in the previous question when you used <code>cor.test()</code>?</p></li>
<li><p>Which of the variables <code>bedrooms</code>, <code>bathrooms</code>, and <code>sqft_living</code> predict housing price? Answer this by conducting the appropriate regression analysis using <code>lm()</code> and assigning the result to an object <code>price_lm</code>. Use the following template:</p></li>
</ol>
<pre class="r"><code>price_lm &lt;- lm(formula = XX ~ XX + XX + XX,
               data = XX)</code></pre>
<ol start="6" style="list-style-type: decimal">
<li><p>Print your <code>price_lm</code> object to see the main results.</p></li>
<li><p>Apply the <code>summary()</code> function to <code>price_lm</code>. Do you see anything new or important?</p></li>
<li><p>Look at the names of the <code>price_lm</code> with <code>names()</code>. What are the named elements of the object?</p></li>
<li><p>Using the <code>$</code> operator, print a vector of the estimated coefficients of the analysis.</p></li>
<li><p>Use the <code>tidy()</code> function (from the <code>broom</code> package) to return a dataframe containing the main results of the test.</p></li>
<li><p>Use the <code>rsq()</code> function (from the <code>rsq</code> package) to obtain the R-squared value. Does this match what you saw in your previous outputs?</p></li>
<li><p>Using the following template, create a new model called <code>everything_lm</code> that predicts housing prices based on <em>all</em> predictors in <code>kc_house</code> <em>except</em> for <code>id</code> and <code>date</code> (<code>id</code> is meaningless and date shouldn’t matter). Use the following template. Note that to include all predictors, we’ll use the <code>formula = y ~.</code> shortcut. We’ll also remove id and date from the dataset using <code>select()</code> before running the analysis.</p></li>
</ol>
<pre class="r"><code>everything_lm &lt;- lm(formula = XX ~.,
                    data = kc_house %&gt;% 
                             select(-id, -date))</code></pre>
<ol start="13" style="list-style-type: decimal">
<li><p>Print your <code>everything_lm</code> object to see the main results.</p></li>
<li><p>Apply the <code>summary()</code> function to <code>everything_lm</code>. Do you see anything new or important?</p></li>
<li><p>Using the <code>$</code> operator, print a vector of the estimated coefficients of the analysis. Are the beta values for bedrooms, bathrooms, and sqft_living different from what you got in your previous analysis <code>price_lm</code>?</p></li>
<li><p>Use the <code>tidy()</code> function to return a dataframe containing the main results of the test.</p></li>
<li><p>Use the <code>rsq()</code> function (from the <code>rsq</code> package) to obtain the R-squared value. How does this R-squared value compare to what you got in your previous regression <code>price_lm</code>?</p></li>
<li><p>How well did the <code>everything_lm</code> model fit the actual housing prices? We can answer this by calculating the average difference between the fitted values and the true values directly. Using the following template, make this calculation. What do you find is the mean absolute difference between the fitted housing prices and the true prices?</p></li>
</ol>
<pre class="r"><code># True housing prices
prices_true &lt;- kc_house$XX

# Model fits (fitted.values)
prices_fitted &lt;- everything_lm$XX

# Calculate absolute error between fitted and true values
abs_error &lt;- abs(XX - XX)

# Calculate mean absolute error
mae &lt;- mean(XX)

# Print the result!
mae</code></pre>
<ol start="19" style="list-style-type: decimal">
<li>Using the following template, create a scatterplot showing the relationship between the fitted values of the <code>everything_lm</code> object and the true prices.</li>
</ol>
<pre class="r"><code># Create dataframe containing fitted and true prices
prices_results &lt;- tibble(truth = XX,
                         fitted = XX)

# Create scatterplot
ggplot(data = prices_results,
       aes(x = fitted, y = truth)) + 
  geom_point(alpha = .1) +
  geom_smooth(method = &#39;lm&#39;) +
  labs(title = &quot;Fitted versus Predicted housing prices&quot;,
       subtitle = paste0(&quot;Mean Absolute Error = &quot;, mae),
       caption = &quot;Source: King County housing price Kaggle dataset&quot;,
       x = &quot;Fitted housing price values&quot;,
       y = &#39;True values&#39;) + 
  theme_minimal()</code></pre>
</div>
<div id="f---logistic-regression-with-glmfamily-binomial" class="section level3">
<h3>F - Logistic regression with glm(family = ‘binomial’)</h3>
<ol style="list-style-type: decimal">
<li>In the next set of analyses, we’ll use logistic regression to predict whether or not a house will sell for over $1,000,000. First, we’ll need to create a new binary variable in the <code>kc_house</code> called <code>million</code> that is 1 when the price is over 1 million, and 0 when it is not. Run the following code to create this new variable</li>
</ol>
<pre class="r"><code># Create a new binary variable called million that
#  indicates when houses sell for more than 1 million

# Note: 1e6 is a shortcut for 1000000

kc_house &lt;- kc_house %&gt;%
                mutate(million = price &gt; 1e6)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Using the following template, use the <code>glm()</code> function to conduct a logistic regression to see which of the variables <code>bedrooms</code>, <code>bathrooms</code>, <code>floors</code>, <code>waterfront</code>, <code>yr_built</code> predict whether or not a house will sell for over 1 Million. Be sure to include the argument <code>family = 'binomial'</code> to tell <code>glm()</code> that we are conducting a logistic regression analysis.</li>
</ol>
<pre class="r"><code># Logistic regression analysis predicting which houses will sell for
#   more than 1 Million

million_glm &lt;- glm(formula = XX ~ XX + XX + XX + XX + XX,
                   data = kc_house,
                   family = &quot;XX&quot;)</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><p>Print your <code>million_glm</code> object to see the main results.</p></li>
<li><p>Apply the <code>summary()</code> function to <code>million_glm</code>.</p></li>
<li><p>Using the <code>$</code> operator, print a vector of the estimated beta values (coefficients) of the analysis.</p></li>
<li><p>Use the <code>tidy()</code> function to return a dataframe containing the main results of the test.</p></li>
<li><p>You can get the fitted probability predictions that each house will sell for more than 1 Million by accessing the vector <code>million_glm$fitted.values</code>. Using this vector, calculate the average probability that houses will sell for more than 1 Million (hint: just take the mean!)</p></li>
<li><p>Using the following code, create a data frame showing the relationship between the fitted probability that a house sells for over 1 Million and the true probability:</p></li>
</ol>
<pre class="r"><code># Just run it!

million_fit &lt;- tibble(pred_million = million_glm$fitted.values,
                      true_million = kc_house$million) %&gt;%
                mutate(fitted_cut = cut(pred_million, breaks = seq(0, 1, .1))) %&gt;%
                group_by(fitted_cut) %&gt;%
                summarise(true_prob = mean(true_million))

million_fit</code></pre>
<ol start="9" style="list-style-type: decimal">
<li>Now plot the results using the following code:</li>
</ol>
<pre class="r"><code># Just run it!

ggplot(million_fit, 
       aes(x = fitted_cut, y = true_prob, col = as.numeric(fitted_cut))) + 
  geom_point(size = 2) +
  labs(x = &quot;Fitted Probability&quot;,
       y = &quot;True Probability&quot;,
       title = &quot;Predicting the probability of a 1 Million house&quot;,
       subtitle = &quot;Using logistic regression with glm(family = &#39;binomial&#39;)&quot;) +
  scale_y_continuous(limits = c(0, 1)) +
  guides(col = FALSE)</code></pre>
</div>
<div id="g---using-predict-to-predict-new-values" class="section level3">
<h3>G - Using predict() to predict new values</h3>
<ol style="list-style-type: decimal">
<li>Your friend Donald just bought a house whose building records have been lost. She wants to know what year her house was likely built. Help Donald figure out when his house was built by conducting the appropriate regression analysis, and then using the specifics of his house to predict the year that his house was built using the <code>predict()</code> function. You know that his house is on the waterfront, has 3 bedrooms, 2 floors and has a condition of 4. The following block of code may help you!</li>
</ol>
<pre class="r"><code># Create regression model predicting year (yr_built)
year_lm &lt;- lm(formula = XX ~ XX + XX + XX + XX,
              data = XX)

# Define Donald&#39;s House
DonaldsHouse &lt;- tibble(waterfront = X,
                       bedrooms = X,
                       floors = X,
                       condition = X)

# Predict the hear of donald&#39;s house
predict(object = year_lm, 
        newdata = DonaldsHouse)</code></pre>
</div>
<div id="x---advanced" class="section level3">
<h3>X - Advanced</h3>
<ol style="list-style-type: decimal">
<li><p>Which variables in the dataset significantly predict the grade of a house? Answer this with a regression analysis.</p></li>
<li><p>Is there an interaction between waterfront and year built (<code>yr_built</code>) on price? In other words, is the relationship between year built and price the same for homes on the waterfront and homes not on the waterfront? Answer this by conducting the appropriate regression analysis and interpret the results. Note: to include an interaction in a model, use the formula <code>y ~ X1 * X2</code> instead of <code>y ~ X1 + X2</code>.</p></li>
<li><p>How well can a regression analysis based on houses sold in 2014 predict housing costs in the 2015? To answer this we’ll create a regression model based on houses sold in 2014 and then use that model to predict the prices of houses sold in 2015. To start, we’ll need to create two new dataframes <code>kc_house_2014</code> and <code>kc_house_2015</code>. Run the code in the following chunk to do this.</p></li>
</ol>
<pre class="r"><code># Just run it!

# Add year_sold to kc_house

kc_house &lt;- kc_house %&gt;%
  mutate(year_sold = year(ymd(date)))

# Create kc_house_2014, 
#    Only houses sold in 2014
kc_house_2014 &lt;- kc_house %&gt;%
  filter(year_sold == 2014)

# Create kc_house_2015, 
#     Only houses sold in 2015
kc_house_2015 &lt;- kc_house %&gt;%
  filter(year_sold == 2015)</code></pre>
<ol start="4" style="list-style-type: decimal">
<li><p>Create a regression model called <code>price_2014_lm</code> that models housing prices in 2014 using only the <code>kc_house_2014</code> data. Note that you may wish to exclude some variables such as <code>id</code>, <code>date</code>, <code>million</code> and <code>year_sold</code>.</p></li>
<li><p>Create a regression model called <code>price_2015_lm</code> that models housing prices in 2015 using only the <code>kc_house_2015</code> data. Include the same exclusion and transformation criterion you used in the previous question.</p></li>
<li><p>Explore and compare the two models, do they look very similar? Very different?</p></li>
<li><p>Calculate the mean absolute error of each model applied to the dataset in which they were created. That is, what was the mean absolute fitted error of each model?</p></li>
<li><p>Using <code>predict()</code>, predict the 2015 housing data based on the <code>price_2014_lm</code> model.</p></li>
<li><p>Calculate the mean absolute error of the <code>price_2014_lm</code> model when applied to the 2015 data. How different was the mean error compared to the mean fitting error of the <code>price_2015_lm</code> model?</p></li>
</ol>
</div>
<div id="generating-random-samples-from-distributions" class="section level3">
<h3>Generating random samples from distributions</h3>
<ol start="10" style="list-style-type: decimal">
<li><p>You can easily generate random samples from statistical distributions in R. To see all of them, run <code>?distributions</code>. For example, to generate samples from the well known Normal distribution, you can use <code>rnorm()</code>. Look at the help menu for <code>rnorm()</code> to see its arguments.</p></li>
<li><p>Let’s explore the <code>rnorm()</code> function. Using <code>rnorm()</code>, create a new object <code>samp_100</code> which is 100 samples from a Normal distribution with mean 10 and standard deviation 5. Print the object to see what the elements look like. What should the mean and standard deviation of this sample? be? Test it by evaluating its mean and standard deviation directly using the appropriate functions. Then, do a one-sample t-test on this sample against the null hypothesis that the true mean is 10. What are the results? Use the following code template to help!</p></li>
</ol>
<pre class="r"><code># Generate 100 samples from a Normal distribution with mean = 10 and sd = 5
samp_100 &lt;- rnorm(n = XX, mean = XX, sd = XX)

# Print result
samp_100

# Calcultae sample mean and standard deviation.
mean(XX)
sd(XX)

t.test(x = XX,   # Vector of values
       mu = XX)  # Mean under null hypothesis</code></pre>
<ol start="12" style="list-style-type: decimal">
<li><p>Repeat the previous block of code several times and look at how the output changes. How do the p-values change when you keep drawing random samples?</p></li>
<li><p>Change the mean under the null hypothesis to 15 instead of 10 and run the code again several times. What happens to the p-values?</p></li>
<li><p>Look at the code below. As you can see, I generate 4 variables x1, x2, x3 and noise. I then create a dependent variable y that is a function of these variables. Finally, I conduct a regression analysis. <em>Before you run the code</em>, what do you expect the value of the <code>coefficients</code> of the regression equation will be? Test your prediction by running the code and exploring the <code>my_lm</code> object.</p></li>
</ol>
<pre class="r"><code># Generate independent variables
x1 &lt;- rnorm(n = 100, mean = 10, sd = 1)
x2 &lt;- rnorm(n = 100, mean = 20, sd = 10)
x3 &lt;- rnorm(n = 100, mean = -5, sd = 5)

# Generate noise
noise &lt;- rnorm(n = 100, mean = 0, sd = 1)

# Create dependent variable
y &lt;- 3 * x1 + 2 * x2 - 5 * x3 + 100 + noise

# Combine all into a tibble
my_data &lt;- tibble(x1, x2, x3, y)

# Calculate my_lm
my_lm &lt;- lm(formula = y ~ x1 + x2 + x3,
              data = my_data)</code></pre>
<ol start="15" style="list-style-type: decimal">
<li>Adjust the code above so that the coefficients for the regression equation will be (close to) <code>(Intercept) = -50</code>, <code>x1 = -3</code>, <code>x2 = 10</code>, <code>x3 = 15</code></li>
</ol>
</div>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<pre class="r"><code># Examples of regression models on the diamonds dataset -------------

library(tidyverse)
library(broom)
library(BayesFactor)
library(lme4)

# First few rows of the diamonds data

diamonds

# Regression ----------------------------

# Q: Run regression predicting price by carat and depth

price_lm &lt;- lm(formula = price ~ carat + depth,
               data = diamonds)

# Print coefficients
price_lm$coefficients

# Regular summary
summary(price_lm)

# Tidy version
tidy(price_lm)


# Q: Run regression predicting price by carat and depth and their interaction

price_lm &lt;- lm(formula = price ~ carat * depth,
               data = diamonds)

# Print coefficients
price_lm$coefficients

# Regular summary
summary(price_lm)

# Tidy version
tidy(price_lm)


# ANOVA ----------------------------

# Q: Run ANOVA predicting price by color and cut

# transform to factor
dimaonds$cut = as.factor(dimaonds$cut)
dimaonds$color = as.factor(dimaonds$color)

# Run model
price_lm &lt;- lm(formula = price ~ cut + color,
               data = diamonds)

# Print coefficients
price_lm$coefficients

# Regular summary
summary(price_lm)

# Tidy version
tidy(price_lm)

# ANOVA version
anova(price_lm)

# Mixed-effects regression ----------------------------

# Q: Run mixed-effect regression predicting carat and depth with the impact of carat varying across color.

# Run model
price_lme &lt;- lmer(formula = price ~ carat + depth + (1 + carat|color),
                  data = diamonds)

# Regular summary
summary(price_lme)


# Bayesian regression ----------------------------

# Q: Run Bayesian regression predicting carat and depth

# Run model
price_Blm &lt;- regressionBF(formula = price ~ carat + depth,
                  data = diamonds)

# Regular summary
price_Blm</code></pre>
</div>
<div id="datasets" class="section level2">
<h2>Datasets</h2>
<table style="width:89%;">
<colgroup>
<col width="8%" />
<col width="9%" />
<col width="11%" />
<col width="59%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">File</th>
<th align="left">Rows</th>
<th align="left">Columns</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="https://raw.githubusercontent.com/therbootcamp/Intro2R_Unibe/master/_sessions/_StatisticsII/1_Data/gap.csv">gap.csv</a></td>
<td align="left">417</td>
<td align="left">9</td>
<td align="left">Country statistics from 1997, 2002, and 2007 from the Gapminder Foundation.</td>
</tr>
</tbody>
</table>
<p>The Gapminder Foundation is a non-profit venture registered in Stockholm, Sweden, that promotes sustainable global development and achievement of the United Nations Millennium Development Goals by increased use and understanding of statistics and other information about social, economic and environmental development at local, national and global levels (see <a href="https://www.gapminder.org">Gapminder.org</a>). The present dataset is an excerpt of their database holding data from three years on economic and health variables of 139 countries.</p>
<table>
<thead>
<tr class="header">
<th align="left">File</th>
<th align="left">Rows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">country</td>
<td align="left">country name</td>
</tr>
<tr class="even">
<td align="left">continent</td>
<td align="left">country’s continent</td>
</tr>
<tr class="odd">
<td align="left">year</td>
<td align="left">measurement year</td>
</tr>
<tr class="even">
<td align="left">lifeExp</td>
<td align="left">life expectancy at birth, in years</td>
</tr>
<tr class="odd">
<td align="left">pop</td>
<td align="left">country’s population</td>
</tr>
<tr class="even">
<td align="left">gdpPercap</td>
<td align="left">country’s GDP per capita (US$)</td>
</tr>
<tr class="odd">
<td align="left">childMort</td>
<td align="left">child mortality (0-5 year-olds dying per 1,000 born)</td>
</tr>
<tr class="even">
<td align="left">co2Emit</td>
<td align="left">CO2 emissions (tonnes per person)</td>
</tr>
<tr class="odd">
<td align="left">healthExp</td>
<td align="left">Government health spending per person (international $)</td>
</tr>
</tbody>
</table>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<div id="packages" class="section level3">
<h3>Packages</h3>
<table>
<thead>
<tr class="header">
<th align="left">Package</th>
<th align="left">Installation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>tidyverse</code></td>
<td align="left"><code>install.packages(&quot;tidyverse&quot;)</code></td>
</tr>
<tr class="even">
<td align="left"><code>broom</code></td>
<td align="left"><code>install.packages(&quot;broom&quot;)</code></td>
</tr>
<tr class="odd">
<td align="left"><code>lme4</code></td>
<td align="left"><code>install.packages(&quot;lme4&quot;)</code></td>
</tr>
<tr class="even">
<td align="left"><code>BayesFactor</code></td>
<td align="left"><code>install.packages(&quot;BayesFactor&quot;)</code></td>
</tr>
</tbody>
</table>
</div>
<div id="functions-1" class="section level3">
<h3>Functions</h3>
<p><em>Model functions</em></p>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Package</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>|    | | |</code></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>glm()</code>, <code>lm()</code></td>
<td align="left">Generalized linear model and linear model</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><em>Inspect models</em></p>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Package</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>summary()</code></td>
<td align="left"><code>base</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>tidy()</code></td>
<td align="left"><code>broom</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>predict()</code></td>
<td align="left"><code>stats</code></td>
<td align="left">Predict</td>
</tr>
<tr class="even">
<td align="left"><code>names()</code></td>
<td align="left"><code>base</code></td>
<td align="left">Print names of model contents.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="resources" class="section level2">
<h2>Resources</h2>
<div id="documentations" class="section level3">
<h3>Documentations</h3>
<ul>
<li><p>For more advanced mixed level ANOVAs with random effects, consult the <code>afex</code> and <code>lmer</code> packages.</p></li>
<li><p>To do Bayesian versions of common hypothesis tests, try using the <code>BayesFactor</code> package. <a href="https://cran.r-project.org/web/packages/BayesFactor/vignettes/manual.html">BayesFactor Guide Link</a></p></li>
</ul>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
